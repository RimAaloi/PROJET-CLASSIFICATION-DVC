stages:
  train:
    deps:
      - src/train.py
      - data/fashion-mnist/fashion-mnist_train.csv
      - data/fashion-mnist/fashion-mnist_test.csv
    cmd: python src/train.py
    outs:
      - models/fashion_classifier.keras
      
  evaluate:
    # Dépendances : Le script, le modèle (sortie du stage 'train') et les données de test
    deps:
      - src/evaluate.py
      - models/fashion_classifier.keras 
      - data/fashion-mnist/fashion-mnist_test.csv
      
    # Commande à exécuter
    cmd: python src/evaluate.py
    
    # Sorties : DVC tracke ces métriques. cache: False assure que le fichier JSON
    # est stocké directement dans Git (car il est petit) et non dans S3.
    metrics:
      - metrics/metrics.json:
          cache: False